import{S,a1 as A,a0 as D,R as E,G as I,c as v,Y as n,$ as h,X as s,L as e,ah as g,a5 as u,W as y,_ as R,O as C,a2 as i,a3 as b,aD as q,V as z,a6 as P,aa as F}from"./index--Bup7wsM.js";import{V as p,a as G,b as w}from"./route-block-1rMb4zMH.js";import{V as x}from"./VDivider-Br2RCJK1.js";import{V as O,a as T}from"./VList-decdPftt.js";import{V as U}from"./VContainer-CcKhHILZ.js";const W={class:"text-center"},X={__name:"cart",setup(Y){const{apiAuth:d}=F(),m=S(),B=A(),_=D(),{t:f}=E(),c=I([]),k=async()=>{try{const{data:t}=await d.get("/user/cart");c.value=t.result}catch(t){console.log(t)}};k();const $=v(()=>c.value.reduce((t,r)=>t+r.product.price*r.quantity,0)),L=v(()=>c.value.length>0&&c.value.every(t=>t.product.sell)),V=async(t,r)=>{var a,l;try{const{data:o}=await d.patch("/user/cart",{product:t,quantity:r});m.cart=o.result,k()}catch(o){console.log(o),_({text:f("api."+(((l=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:l.message)||"unknownError")),snackbarProps:{color:"red"}})}},N=async()=>{var t,r;try{await d.post("/order"),m.cart=0,B.push("/orders")}catch(a){console.log(a),_({text:f("api."+(((r=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(t,r)=>(n(),h(U,null,{default:s(()=>[e(G,null,{default:s(()=>[e(p,{cols:"12"},{default:s(()=>[g("h1",W,u(t.$t("nav.cart")),1)]),_:1}),e(x),e(p,{cols:"12"},{default:s(()=>[e(O,{lines:"two"},{default:s(()=>[(n(!0),y(C,null,R(c.value,(a,l)=>(n(),y(C,{key:a._id},[e(T,{title:a.product.name,subtitle:a.product.price,"active-class":"bg-red",active:!a.product.sell},{prepend:s(()=>[e(q,{rounded:"0"},{default:s(()=>[e(z,{src:a.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[e(i,{color:"red",icon:"mdi-minus",size:"small",class:"mr-2",onClick:o=>V(a.product._id,-1)},null,8,["onClick"]),b(" "+u(a.quantity)+" ",1),e(i,{color:"green",icon:"mdi-plus",size:"small",class:"ml-2",onClick:o=>V(a.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),l<c.value.length-1?(n(),h(x,{key:0})):P("",!0)],64))),128))]),_:1})]),_:1}),e(p,{cols:"12",class:"text-center"},{default:s(()=>[g("p",null,u($.value),1),e(i,{color:"primary",disabled:!L.value,onClick:N},{default:s(()=>[b(u(t.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof w=="function"&&w(X);export{X as default};
