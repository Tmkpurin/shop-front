import{p as ue,ai as se,aj as ye,q as ie,E as de,ak as ce,al as be,c as $,J as me,am as ve,an as _,L as a,M as E,ao as xe,ap as he,G as V,s as ke,d as we,o as Ce,w as N,b as Pe,aq as Fe,ar as Se,O as L,as as ae,at as Ae,au as Re,av as $e,aw as Ie,Q as W,ax as Be,a as Me,ay as Ue,R as De,a0 as Te,az as qe,U as Ne,Y as le,W as ze,X as s,ah as Ee,a5 as S,a2 as j,a3 as R,a4 as He,af as X,V as Ge,$ as Oe,a6 as je,Z as d,aA as Le,ae as _e,ab as Je,ad as Qe,aB as We,aC as Xe,aa as Ye,a9 as Ze}from"./index--Bup7wsM.js";import{c as Ke,a as Y,b as et,d as tt,u as at,e as z,V as lt}from"./index.esm-o79gFL4N.js";import{a as ot,V as oe,b as re}from"./route-block-1rMb4zMH.js";import{V as rt}from"./VDivider-Br2RCJK1.js";import{m as nt,a as ne,V as ut,b as st}from"./VDataTable-BFtRv-eI.js";import{V as it}from"./VToolbar-BJhW00Ph.js";import{V as dt}from"./VContainer-CcKhHILZ.js";import"./VPagination-RRUdbx7L.js";import"./VList-decdPftt.js";import"./VMenu-C-b1TX5s.js";const ct=ue({...se(),...ye(nt(),["inline"])},"VCheckbox"),mt=ie()({name:"VCheckbox",inheritAttrs:!1,props:ct(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,n){let{attrs:y,slots:p}=n;const i=de(e,"modelValue"),{isFocused:c,focus:b,blur:I}=ce(e),m=be(),B=$(()=>e.id||`checkbox-${m}`);return me(()=>{const[M,D]=ve(y),U=_.filterProps(e),x=ne.filterProps(e);return a(_,E({class:["v-checkbox",e.class]},M,U,{modelValue:i.value,"onUpdate:modelValue":k=>i.value=k,id:B.value,focused:c.value,style:e.style}),{...p,default:k=>{let{id:f,messagesId:w,isDisabled:g,isReadonly:C,isValid:P}=k;return a(ne,E(x,{id:f.value,"aria-describedby":w.value,disabled:g.value,readonly:C.value},D,{error:P.value===!1,modelValue:i.value,"onUpdate:modelValue":T=>i.value=T,onFocus:b,onBlur:I}),p)}})}),{}}}),vt=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...se(),...xe()},"VTextarea"),ft=ie()({name:"VTextarea",directives:{Intersect:he},inheritAttrs:!1,props:vt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,n){let{attrs:y,emit:p,slots:i}=n;const c=de(e,"modelValue"),{isFocused:b,focus:I,blur:m}=ce(e),B=$(()=>typeof e.counterValue=="function"?e.counterValue(c.value):(c.value||"").toString().length),M=$(()=>{if(y.maxlength)return y.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function D(r,t){var u,h;!e.autofocus||!r||(h=(u=t[0].target)==null?void 0:u.focus)==null||h.call(u)}const U=V(),x=V(),k=ke(""),f=V(),w=$(()=>e.persistentPlaceholder||b.value||e.active);function g(){var r;f.value!==document.activeElement&&((r=f.value)==null||r.focus()),b.value||I()}function C(r){g(),p("click:control",r)}function P(r){p("mousedown:control",r)}function T(r){r.stopPropagation(),g(),W(()=>{c.value="",Be(e["onClick:clear"],r)})}function H(r){var u;const t=r.target;if(c.value=t.value,(u=e.modelModifiers)!=null&&u.trim){const h=[t.selectionStart,t.selectionEnd];W(()=>{t.selectionStart=h[0],t.selectionEnd=h[1]})}}const v=V(),A=V(+e.rows),q=$(()=>["plain","underlined"].includes(e.variant));we(()=>{e.autoGrow||(A.value=+e.rows)});function l(){e.autoGrow&&W(()=>{if(!v.value||!x.value)return;const r=getComputedStyle(v.value),t=getComputedStyle(x.value.$el),u=parseFloat(r.getPropertyValue("--v-field-padding-top"))+parseFloat(r.getPropertyValue("--v-input-padding-top"))+parseFloat(r.getPropertyValue("--v-field-padding-bottom")),h=v.value.scrollHeight,G=parseFloat(r.lineHeight),J=Math.max(parseFloat(e.rows)*G+u,parseFloat(t.getPropertyValue("--v-input-control-height"))),Q=parseFloat(e.maxRows)*G+u||1/0,F=Ue(h??0,J,Q);A.value=Math.floor((F-u)/G),k.value=Me(F)})}Ce(l),N(c,l),N(()=>e.rows,l),N(()=>e.maxRows,l),N(()=>e.density,l);let o;return N(v,r=>{r?(o=new ResizeObserver(l),o.observe(v.value)):o==null||o.disconnect()}),Pe(()=>{o==null||o.disconnect()}),me(()=>{const r=!!(i.counter||e.counter||e.counterValue),t=!!(r||i.details),[u,h]=ve(y),{modelValue:G,...J}=_.filterProps(e),Q=Fe(e);return a(_,E({ref:U,modelValue:c.value,"onUpdate:modelValue":F=>c.value=F,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":q.value},e.class],style:e.style},u,J,{centerAffix:A.value===1&&!q.value,focused:b.value}),{...i,default:F=>{let{id:O,isDisabled:Z,isDirty:K,isReadonly:fe,isValid:pe}=F;return a(Se,E({ref:x,style:{"--v-textarea-control-height":k.value},onClick:C,onMousedown:P,"onClick:clear":T,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Q,{id:O.value,active:w.value||K.value,centerAffix:A.value===1&&!q.value,dirty:K.value||e.dirty,disabled:Z.value,focused:b.value,error:pe.value===!1}),{...i,default:ge=>{let{props:{class:ee,...te}}=ge;return a(L,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),ae(a("textarea",E({ref:f,class:ee,value:c.value,onInput:H,autofocus:e.autofocus,readonly:fe.value,disabled:Z.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:g,onBlur:m},te,h),null),[[Ae("intersect"),{handler:D},null,{once:!0}]]),e.autoGrow&&ae(a("textarea",{class:[ee,"v-textarea__sizer"],id:`${te.id}-sizer`,"onUpdate:modelValue":Ve=>c.value=Ve,ref:v,readonly:!0,"aria-hidden":"true"},null),[[Re,c.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:t?F=>{var O;return a(L,null,[(O=i.details)==null?void 0:O.call(i,F),r&&a(L,null,[a("span",null,null),a($e,{active:e.persistentCounter||b.value,value:B.value,max:M.value,disabled:e.disabled},i.counter)])])}:void 0})}),Ie({},U,x,f)}}),pt={class:"text-center"},gt={__name:"products",setup(e){const{t:n}=De(),{apiAuth:y}=Ye(),p=Te(),i=qe([]),c=V(""),b=$(()=>[{title:"ID",key:"_id",sortable:!0},{title:n("product.image"),key:"image",sortable:!1},{title:n("product.name"),key:"name",sortable:!0},{title:n("product.description"),key:"description",sortable:!0},{title:n("product.price"),key:"price",sortable:!0},{title:n("product.category"),key:"category",sortable:!0},{title:n("product.sell"),key:"sell",sortable:!0},{title:n("product.createdAt"),key:"createdAt",sortable:!0},{title:n("product.updatedAt"),key:"updatedAt",sortable:!0},{title:n("adminProduct.edit"),key:"edit",sortable:!1}]),I=async()=>{var l,o;try{const{data:r}=await y.get("/product/all");i.push(...r.result)}catch(r){console.log(r),p({text:n("api."+(((o=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:o.message)||"unknownError")),snackbarProps:{color:"red"}})}};I();const m=V({open:!1,id:""}),B=l=>{l&&(m.value.id=l._id,f.value.value=l.name,w.value.value=l.price,g.value.value=l.description,C.value.value=l.category,P.value.value=l.sell),m.value.open=!0},M=()=>{k(),m.value.id="",m.value.open=!1,H.value.deleteFileRecord()},D=Ke({name:Y().required(n("api.productNameRequired")),price:et().typeError(n("api.productPriceRequired")).required(n("api.productPriceRequired")).min(0,n("api.productPriceTooSmall")),description:Y().required(n("api.productDescriptionRequired")),category:Y().required(n("api.productCategoryRequired")).oneOf(["food","drink","music","phone"],n("api.productCategoryInvalid")),sell:tt().required(n("api.productSellRequired"))}),{handleSubmit:U,isSubmitting:x,resetForm:k}=at({validationSchema:D,initialValues:{name:"",price:0,description:"",category:"",sell:!1}}),f=z("name"),w=z("price"),g=z("description"),C=z("category"),P=z("sell"),T=$(()=>[{text:n("productCategory.food"),value:"food"},{text:n("productCategory.drink"),value:"drink"},{text:n("productCategory.music"),value:"music"},{text:n("productCategory.phone"),value:"phone"}]),H=V(null),v=V([]),A=V([]),q=U(async l=>{var o,r,t;if((o=v.value[0])!=null&&o.error&&m.value.id.length===0&&v.value.length===0){p({text:n("api.productImageRequired"),snackbarProps:{color:"red"}});return}try{const u=new FormData;u.append("name",l.name),u.append("price",l.price),u.append("description",l.description),u.append("category",l.category),u.append("sell",l.sell),v.value.length>0&&u.append("image",v.value[0].file),m.value.id.length>0?await y.patch("/product/"+m.value.id,u):await y.post("/product",u),i.splice(0,i.length),I(),p({text:n(m.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),M()}catch(u){console.log(u),p({text:n("api."+(((t=(r=u==null?void 0:u.response)==null?void 0:r.data)==null?void 0:t.message)||"unknownErorr")),snackbarProps:{color:"red"}})}});return(l,o)=>{const r=Ne("VueFileAgent");return le(),ze(L,null,[a(dt,null,{default:s(()=>[a(ot,null,{default:s(()=>[a(oe,{cols:"12"},{default:s(()=>[Ee("h1",pt,S(l.$t("nav.adminProducts")),1)]),_:1}),a(rt),a(oe,{cols:"12"},{default:s(()=>[a(ut,{items:i,headers:b.value,search:c.value},{top:s(()=>[a(it,null,{default:s(()=>[a(j,{onClick:o[0]||(o[0]=t=>B(null))},{default:s(()=>[R(S(l.$t("adminProduct.new")),1)]),_:1}),a(He),a(X,{modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=t=>c.value=t),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.image":s(({value:t})=>[a(Ge,{src:t,height:"50"},null,8,["src"])]),"item.sell":s(({value:t})=>[t?(le(),Oe(Ze,{key:0,icon:"mdi-check"})):je("",!0)]),"item.createdAt":s(({value:t})=>[R(S(new Date(t).toLocaleString()),1)]),"item.updatedAt":s(({value:t})=>[R(S(new Date(t).toLocaleString()),1)]),"item.category":s(({value:t})=>[R(S(l.$t("productCategory."+t)),1)]),"item.edit":s(({item:t})=>[a(j,{icon:"mdi-pencil",variant:"text",onClick:u=>B(t)},null,8,["onClick"])]),_:2},1032,["items","headers","search"])]),_:1})]),_:1})]),_:1}),a(Xe,{modelValue:m.value.open,"onUpdate:modelValue":o[9]||(o[9]=t=>m.value.open=t),persistent:""},{default:s(()=>[a(lt,{disabled:d(x),onSubmit:Le(d(q),["prevent"])},{default:s(()=>[a(_e,null,{default:s(()=>[a(Je,null,{default:s(()=>[R(S(l.$t(m.value.id?"adminProduct.edit":"adminProduct.new")),1)]),_:1}),a(Qe,null,{default:s(()=>[a(X,{modelValue:d(f).value.value,"onUpdate:modelValue":o[2]||(o[2]=t=>d(f).value.value=t),label:l.$t("product.name"),"error-messages":d(f).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(X,{modelValue:d(w).value.value,"onUpdate:modelValue":o[3]||(o[3]=t=>d(w).value.value=t),label:l.$t("product.price"),"error-messages":d(w).errorMessage.value,type:"number",min:"0"},null,8,["modelValue","label","error-messages"]),a(st,{modelValue:d(C).value.value,"onUpdate:modelValue":o[4]||(o[4]=t=>d(C).value.value=t),"error-messages":d(C).errorMessage.value,items:T.value,label:l.$t("product.category"),"item-title":"text","item-value":"value"},null,8,["modelValue","error-messages","items","label"]),a(mt,{modelValue:d(P).value.value,"onUpdate:modelValue":o[5]||(o[5]=t=>d(P).value.value=t),label:l.$t("product.onSell"),"error-messages":d(P).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(ft,{modelValue:d(g).value.value,"onUpdate:modelValue":o[6]||(o[6]=t=>d(g).value.value=t),label:l.$t("product.description"),"error-messages":d(g).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(r,{ref_key:"fileAgent",ref:H,modelValue:v.value,"onUpdate:modelValue":o[7]||(o[7]=t=>v.value=t),"raw-model-value":A.value,"onUpdate:rawModelValue":o[8]||(o[8]=t=>A.value=t),accept:"image/jpeg, image/png",deletable:"","max-size":"1MB","help-text":l.$t("fileAgent.helpText"),"error-text":{type:l.$t("fileAgent.errorType"),size:l.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),a(We,null,{default:s(()=>[a(j,{onClick:M},{default:s(()=>[R(S(l.$t("adminProduct.cancel")),1)]),_:1}),a(j,{type:"submit",loading:d(x)},{default:s(()=>[R(S(l.$t("adminProduct.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof re=="function"&&re(gt);export{gt as default};
